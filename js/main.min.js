!function(){let e,t;window.onload=function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)}),e=document.querySelector("#new-todo-input"),t=document.querySelector("#new-todo-button"),t.onclick=n,document.body.onkeydown=u,o=new r,(s=new a).display()};let o,s=[];const i="todos-container",d="TODO-LIST",l="todo-fadeout";function n(){s.add(e.value)}class a{constructor(e){this.todos=e||o.toArray()||[]}add(t){t&&0!=t.length&&(e.value="",t instanceof c==0&&(t=new c(t)),this.todos.push(t),t.save(),t.display())}update(e){const t=this.indexOf(e);this.todos[t]=e}display(){this.todos&&this.todos.forEach(e=>{e.display()})}indexOf(e){return this.todos.indexOf(e)}splice(e,t){return this.todos.splice(e,t)}}class c{constructor(e){"object"==typeof e?(this.value=e.value,this.completed=e.completed,this.key=e.key):(this.value=e,this.completed=!1,this.key=Math.floor(99999999*Math.random())),this.elt=this.toHtml()}delete(){this.deleteElement(),o.remove(this),s.update()}deleteElement(){this.elt.classList.add(l),this.elt.addEventListener("animationend",e=>document.getElementById(i).removeChild(this.elt))}completeToggle(e){e?(this.completed=e,this.completeClassToggle(e),this.update()):(this.completed=!this.completed,this.completeClassToggle(),this.update())}completeClassToggle(e){e?e?this.elt.classList.add("completed"):this.elt.classList.remove("completed"):this.elt.classList.toggle("completed")}save(){o.add(this)}display(){let e=document.getElementById(i)||document.createElement("div");e.id!=i&&(e.id=i,document.querySelector("main").appendChild(e)),e.appendChild(this.elt),this.completed&&this.completeToggle(!0)}update(){s.update(this),o.update(this)}toHtml(){const e=document.createElement("div");e.classList.add("todo-container");const t=document.createElement("div");t.id="todo-value",t.innerText=this.value;const o=document.createElement("button");o.id="complete-toggle",o.classList.add("material-icons"),o.classList.add("todo-button"),o.innerText="done",o.addEventListener("click",e=>this.completeToggle());const s=document.createElement("button");return s.id="delete-button",s.classList.add("material-icons"),s.classList.add("todo-button"),s.innerText="delete",s.addEventListener("click",e=>this.delete()),e.appendChild(t),e.appendChild(o),e.appendChild(s),e}}class r{update(e){let t=this.toArray();t[this.getIndex(e)]=e,o.set(t)}add(e){e.key||(e.key=this.getRandomKey());let t=this.toArray()||[];t.push(e),o.set(t)}set(e){e=JSON.stringify(e),localStorage.setItem(d,e)}getIndex(e){const t=this.toArray();for(let o=0;o<t.length;o++)if(t[o].key===e.key)return o}getRandomKey(){return Math.floor(9999999999*Math.random())}toArray(){if(!localStorage.getItem(d))return;const e=JSON.parse(localStorage.getItem(d));for(let t=0;t<e.length;t++)e[t]=new c(e[t]);return e||[]}remove(e){let t=this.toArray();const o=this.getIndex(e);t.splice(o,1),this.set(t)}}const h={13:n};const u=e=>{h[e.keyCode]&&h[e.keyCode]()}}();
